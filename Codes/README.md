Core code of the model architecture
